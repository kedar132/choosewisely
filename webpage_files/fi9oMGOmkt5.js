/*!CK:1810145006!*//*1433125003,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Gu7VU"]); }

__d("ComposedEntityMutability",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MUTABLE:0,IMMUTABLE:1,SEGMENTED:2};},null);
__d("getScrollPosition",["getDocumentScrollElement","getUnboundedScrollPosition"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(j){var k=g();if(j===window)j=k;var l=h(j),m=j===k?document.documentElement:j,n=j.scrollWidth-m.clientWidth,o=j.scrollHeight-m.clientHeight;l.x=Math.max(0,Math.min(l.x,n));l.y=Math.max(0,Math.min(l.y,o));return l;}e.exports=i;},null);
__d("LitestandNewStoryController",["Animation","Arbiter","AsyncRequest","CSS","Event","LitestandMessages","LitestandStream","NavigationMessage","Run","Style","SubscriptionsHandler","TinyViewport","ge","getScrollPosition","memoize","$","queryThenMutateDOM","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();var y=1,z,aa,ba=500,ca=600,da,ea;function fa(){ea&&clearTimeout(ea);ea=null;}function ga(){ea=setTimeout(function(){ea=null;ha();},ba);}function ha(){var ab;w(function(){ab=m.canInsertNewerStories();},function(){if(ab){xa();}else ga();},'LitestandNewStoryController/tryShowingStories');}var ia=0,ja,ka=true,la;function ma(){if(!la){la=new q();la.addSubscriptions(h.subscribe(n.NAVIGATION_BEGIN,ua),k.listen(window,'resize',na),k.listen(window,'scroll',sa));o.onLeave(ua);}}function na(){if(!pa())ua();}var oa=u(function(){var ab=s('blueBarNAXAnchor');return ab&&j.hasClass(ab,'fixed_elem');});function pa(){return oa()&&!r.isTiny();}function qa(ab,bb){var cb=s(ab);if(cb)cb.style.marginTop=bb?bb+'px':'';}function ra(ab){if(!pa()){ab=0;}else ab=Math.max(ab,0);ia=ab;qa('rightCol',ab);qa('leftCol',ab);}function sa(){var ab=t(window).y;if(ab<=0){ua();return;}if(ab<ia){ka=false;ra(ab);}if(aa&&ab>aa+50&&z){z.hide();aa=null;}aa=ab;}function ta(){if(!ka){ja&&ja.stop();ja=null;}}function ua(){if(la){la&&la.release();ka=false;ra(0);la=null;if(z){z.hide();aa=null;}}}function va(ab,bb){ja=new g(ab).from('opacity',0).to('opacity',1).duration(ca);if(bb){ka=true;for(var cb=0;cb<y;cb++)ja.checkpoint(1,ta).from('opacity',1).to('opacity',0).duration(ca).checkpoint().from('opacity',0).to('opacity',1).duration(ca);}ja.go();}function wa(ab){fa();if(!da)return;if(ab)var bb=t(window),cb=da.nextSibling,db=cb.offsetTop,eb=function(){ra(bb.y+cb.offsetTop-db);window.scrollTo(bb.x,ia);};p.apply(da,{height:'',left:'',overflow:'',position:'',width:''});if(ab){eb();var fb=da;x(function(){ma();eb();va(fb,true);if(z){z.setAtTop();z.show();}});}else va(da,false);h.inform(l.STORIES_INSERTED);h.inform(l.NEWER_STORIES_INSERTED);setTimeout(function(){h.inform('reflow');},0);new i().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:m.getSectionID()}).send();da=null;h.inform(l.NEW_STORIES_DISPLAYED);}function xa(){wa(pa());}function ya(){wa(false);}var za={waitForDisplay:function(ab){if(!da)da=v(ab);if(m.canInsertNewerStories()){xa();}else ga();},showStoriesNow:function(ab){da=ab;ya();},setNewStoryPill:function(ab){z=ab;}};e.exports=za;},null);
__d("LiveFeedBar",["Arbiter","BanzaiScuba","DOM","Event","Run","throttle","SubscriptionsHandler","LitestandMessages","LitestandNewStoryController","ViewportBounds","CurrentUser","getElementPosition","NavigationMessage","Vector","NewStoriesPillConfig","UserActivity","FbFeedViewportTracking","WaitBeforeNewStoryQE","ViewportAtFeedTop","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa;z(['LitestandStoryInsertionStatus'],function(va){aa=va;});var ba=null,ca=false,da=0,ea=0,fa,ga,ha=0,ia=1,ja=2,ka=ha,la,ma=200,na,oa=function(va,wa){wa=wa!==(void 0)?wa:-1;new h('feed_newstoriescard').addNormal('user_id',q.getID()).addNormal('event',va).addInteger('time',Math.round(Date.now()/1000)).addInteger('bar_is_visible',ca?1:0).addInteger('story_count',ea).addInteger('stories_fetched',wa).addInteger('load_requests_before_click',da).post();},pa=function(){var va=u.pill_story_cnt;if(!va)va=2;if(ea>=va&&!ca){ba.show();oa('render');ca=true;}},qa=function(){if(ca){ba.hide();ca=false;}},ra={},sa=function(){var va=false,wa=w.getInstance(),xa=p.getTop();for(var ya in ra){if(wa.hasBeenVisible(ya)){delete ra[ya];continue;}var za=ra[ya];if(xa<=r(za).y){va=true;break;}}return va;},ta=false,ua={init:function(va){if(ta)return;ta=true;ba=va;ka=ha;this._scrollDownWaitTimeMs=u.scroll_down_wait_time_ms;this._scrollThrottleTimeMs=u.scroll_throttle_time_ms;ma=u.pill_scroll_threshold;this._subscriptions=new m();ua._scrollDownWaitTimeout();this._subscriptions.addSubscriptions(va.subscribe('click',this._barClickHandler),g.subscribe(n.NEW_STORIES_DISPLAYED,function(){ea=0;}),g.subscribe('Stream/totalHeadLoadedStories',function(wa,xa){this._liveUpdatesAvailable(xa.hiddenCount,xa.fblogo);}.bind(this)),j.listen(window,'scroll',l(this._handleScroll.bind(this),this._scrollThrottleTimeMs,this)),g.subscribe(n.PILL_PAGELET_REQUEST_SENT,function(){da+=1;oa('load_request');}),g.subscribe(s.NAVIGATION_BEGIN,this._cleanup.bind(this)),g.subscribe(n.NEW_STORIES_CONTAINER_CREATED,function(wa,xa){na=xa;}));if(x.showPillAfterMove)this._subscriptions.addSubscriptions(j.listen(window,'focus',function(){ua._processStories(true);}));k.onLeave(this._cleanup.bind(this));},_handleScrollUp:function(){if(ka!==ia){ka=ia;la=fa;}else if(la-fa>ma)ua._processStories(true);},_handleScrollDown:function(){if(ka!==ja){ka=ja;la=fa;}else if(fa-la>ma)qa();},_handleScroll:function(){ga=fa;fa=t.getScrollPosition().y;if(ga!==(void 0)&&fa!==(void 0))if(fa<ga){this._handleScrollUp();}else this._handleScrollDown();},_barClickHandler:function(){oa('click');da=0;ea=0;qa();na&&o.showStoriesNow(na);},_scrollDownWaitTimeout:function(){var va=ua._scrollDownWaitTimeMs;if(!v.isActive(ua._scrollDownWaitTimeMs)){ua._processStories(false);}else{var wa=Date.now()-v.getLastActive();va=ua._scrollDownWaitTimeMs-wa;}this._scrollDownTimeoutListener=setTimeout(ua._scrollDownWaitTimeout,va);},_processStories:function(va){if(ea>0)if(y.isTrue()){qa();if(na)if(va){o.showStoriesNow(na);}else o.waitForDisplay(i.getID(na));ea=0;}else if(va||(!sa()&&(!aa||aa.canInsert())))pa();},_liveUpdatesAvailable:function(va,wa){oa('load_response',va-ea);ea=va;if(ea>0)if(y.isTrue()){qa();if(wa){o.showStoriesNow(na);}else o.waitForDisplay(i.getID(na));ea=0;}else if(!v.isActive(ua._scrollDownWaitTimeMs)&&!sa()&&(!aa||aa.canInsert()))pa();},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;this._scrollDownTimeoutListener&&clearTimeout(this._scrollDownTimeoutListener);this._scrollDownTimeoutListener=null;ta=false;ka=ha;},insertUnseenStory:function(va,wa){if(va)ra[va]=wa;},getStoryCount:function(){return ea;}};e.exports=ua;},null);
__d("FeedLiveUpdateBar",["ArbiterMixin","Animation","BanzaiScuba","Ease","DOM","DOMScroll","Event","Vector","copyProperties","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=300,r=false;function s(u){this.element=u;this.init();}function t(u){new i('feed_newstoriescard').addNormal('event',u).addInteger('time',Math.round(Date.now()/1000)).addInteger('bar_at_top',1).post();}o(s.prototype,g,{init:function(){if(!this.element)return;this.hide();var u=k.find(this.element,"._2f6b");m.listen(u,'click',this._handleClick.bind(this));},_handleClick:function(event){if(r)t('click');this.hide();var u=new n(n.getScrollPosition().x,0,'document');l.scrollTo(u,q,false,false,0,function(){l.scrollTo(u,0);this.inform('click');}.bind(this));event.kill();},setAtTop:function(){r=true;},hide:function(){r=false;new h(this.element).from('top',42).to('top',-50).ease(j.sineOut()).duration(250).hide().go();},show:function(){if(!this.element)return;new h(this.element).from('top',-50).to('top',42).ease(j.makePowerOut(3)).duration(400).show().go();if(r)t('render');}});e.exports=s;},null);